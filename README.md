# Архитектура проекта "Разработка модели ИИ для категоризации рекламных баннеров"

## Оглавление

1. [Общий обзор](#1-общий-обзор)
2. [Цели проекта](#2-цели-проекта)
3. [Ожидаемые бизнес-преимущества](#3-ожидаемые-бизнес-преимущества)
4. [Условия и ограничения](#4-условия-и-ограничения)
5. [Нефункциональные требования](#5-нефункциональные-требования)
   - [Производительность](#51-производительность)
   - [Масштабируемость](#52-масштабируемость)
   - [Доступность](#53-доступность)
   - [Надёжность](#54-надёжность)
   - [Безопасность](#55-безопасность)
   - [Тиражирование](#56-тиражирование)
   - [Документация](#57-документация)
6. [Основные компоненты](#6-основные-компоненты)
   - [Хранение данных](#61-хранение-данных)
   - [Описание файлов и папок](#62-описание-файлов-и-папок)
7. [CI/CD и автоматизация](#7-cicd-и-автоматизация)
8. [Установка и использование](#8-установка-и-использование)
9. [Поддержка и обратная связь](#9-поддержка-и-обратная-связь)
---

## 1. Общий обзор

Проект предназначен для автоматизированной модерации макетов и видео с использованием ИИ. Основные функции включают:
- Анализ макетов и видео на соответствие юридическим требованиям и техническому заданию.
- Анализ документов с помощью OCR и NLP.
- Поиск похожих изображений.
- Авторазметку данных для обучения моделей.
- Масштабируемость, высокая доступность и интеграция с внешними сервисами.

> **Примечание**: Не все компоненты представлены в проекте ввиду коммерческой тайны.

---

## 2. Цели проекта

1. Реализовать и внедрить искусственный интеллект для целей модерации макетов.
2. Обеспечить интеграцию ИИ с внешними системами (АПР и РуссОнлайн).
3. Создать механизмы для быстрого обновления и переобучения моделей.
4. Обеспечить высокую доступность и надёжность системы.

---

## 3. Ожидаемые бизнес-преимущества

- **Повышение скорости модерации макетов**: Автоматизация процессов анализа и классификации.
- **Сокращение ручного труда**: Уменьшение зависимости от человеческого фактора.
- **Автоматизация обнаружения схожих макетов**: Группировка макетов для упрощения модерации.
- **Оптимизация взаимодействия служб**: Улучшение координации между отделами.
- **Повышение качества клиентского сервиса**: Быстрое и точное выполнение задач модерации.

---

## 4. Условия и ограничения

1. **Интеграция с внешними системами**: ИИ должен интегрироваться с АПР и РуссОнлайн для обмена информацией.
2. **Гибкость критериев анализа**: Анализ макета по каждому критерию должен быть отделим от общего алгоритма. При изменении требований должна быть возможность:
   - Деактивировать старый критерий.
   - Переобучить ИИ.
   - Добавить новый критерий.
3. **Резервное копирование**: Реализовать возможность резервного копирования ИИ на момент времени.
4. **Мониторинг деградации ИИ**: Реализовать механизм выборочной проверки результатов для идентификации возможной деградации.

---

## 5. Нефункциональные требования

### 5.1 Производительность
- Время анализа 10 000 макетов не должно превышать 10 минут.

### 5.2 Масштабируемость
- Система должна масштабироваться для обработки больших объёмов данных.

### 5.3 Доступность
- Система должна быть доступна 24/7.
- Допустимое время простоя:
  - В час: не более 1 минуты (коэффициент доступности 98%).
  - В сутки: не более 20 минут (коэффициент доступности 98,6%).
  - В месяц: не более 5 часов (коэффициент доступности 99,3%).

### 5.4 Надёжность
- Вероятность сбоя: не более 5% обращений.
- Восстановление после сбоя: не более 5 минут.
- Сбой в одной из систем не должен приводить к сбою в других.

### 5.5 Безопасность
- Чувствительные данные (секреты) должны храниться в переменных окружения.
- Используемые Docker-образы не должны содержать известных уязвимостей.
- Критерий успеха: при деплое все проверки (trivy, semgrep, gitleaks, trufflehog3, sonarqube, pybandit) должны проходить без критических замечаний.
- Обработка и передача данных должны исключать возможность утечки информации.

### 5.6 Тиражирование
- Система предназначена для внутреннего использования в компании.
- Должна быть возможность создавать копии системы для применения в различных бизнес-процессах.
- Запуск в производственный тираж не планируется.

### 5.7 Документация
- Для всех сервисов должно быть предоставлено описание по стандартному шаблону компании.
- Все API должны быть задокументированы с использованием Swagger (стандарт OpenApi).
- Для пользователей должна быть доступна справка по функциональным возможностям системы.
- В справке должны быть обучающие ролики, описывающие бизнес-процессы для разных групп пользователей.

---

## 6. Основные компоненты

### 6.1 Хранение данных

Данные проекта хранятся в следующей структуре:

```
moderation-ai/
├── README.md
├── requirements.txt
├── setup.py
├── scripts/
│   ├── run_comet_pipeline.sh
│   ├── run_comet_pipeline.py
│   ├── notify_bot.py
│   ├── parse_log_to_excel.py
│   ├── qwen_vl_utils.py
│   ├── process_images.py
│   ├── auto_annotation.py
│   ├── README.md
├── data/
│   ├── images/
│   ├── models/
│   ├── logs/
│   ├── results/
│   ├── README.md
├── docs/
│   ├── api_documentation.md
│   ├── user_manual.md
│   ├── training_videos/
│   ├── README.md
├── tests/
│   ├── test_processing.py
│   ├── test_notifications.py
│   ├── README.md
├── .github/
│   └── workflows/
│       ├── generator-generic-ossf-slsa3-publish.yml
│       ├── python-package-conda.yml
│       └── python-publish.yml
```

### 6.2 Описание файлов и папок

1. **README.md**  
   Основной файл с описанием проекта, инструкциями по установке, настройке и запуску.

2. **requirements.txt**  
   Файл с перечислением всех необходимых Python-пакетов для проекта.

3. **setup.py**  
   Файл для настройки пакета проекта. Включает:
   - Зависимости (`install_requires`).
   - Консольные команды для запуска скриптов (`entry_points`).
   - Метаданные проекта (автор, описание, лицензия).

4. **scripts/**  
   Папка с основными исполняемыми скриптами:
   - **run_comet_pipeline.sh** — Bash-скрипт для запуска процесса обучения модели.
   - **run_comet_pipeline.py** — Python-скрипт для обучения модели YOLO.
   - **notify_bot.py** — Скрипт для отправки уведомлений через Telegram.
   - **parse_log_to_excel.py** — Скрипт для обработки логов и сохранения их в Excel.
   - **qwen_vl_utils.py** — Вспомогательные функции для работы с моделью Qwen2VL.
   - **process_images.py** — Скрипт для обработки изображений и анализа их содержания.
   - **auto_annotation.py** — Скрипт для автоматической разметки изображений с использованием YOLO.

5. **data/**  
   Папка для хранения данных:
   - **images/** — Изображения для анализа.
   - **models/** — Обученные модели.
   - **logs/** — Логи выполнения скриптов.
   - **results/** — Результаты анализа изображений.

6. **docs/**  
   Документация проекта:
   - **api_documentation.md** — Описание API проекта.
   - **user_manual.md** — Руководство пользователя.
   - **training_videos/** — Видеоинструкции по использованию системы.

7. **tests/**  
   Тесты для проверки функциональности проекта:
   - **test_processing.py** — Тесты для проверки обработки изображений.
   - **test_notifications.py** — Тесты для проверки системы уведомлений.

8. **.github/workflows/**  
   Папка с конфигурациями GitHub Actions для CI/CD:
   - **generator-generic-ossf-slsa3-publish.yml** — Конфигурация для публикации пакета с использованием SLSA3.
   - **python-package-conda.yml** — Конфигурация для сборки и публикации пакета с использованием Conda.
   - **python-publish.yml** — Конфигурация для публикации Python-пакета.

---


## 7. CI/CD и автоматизация

Проект использует GitHub Actions для автоматизации процессов CI/CD. В папке `.github/workflows/` находятся следующие конфигурации:
- **generator-generic-ossf-slsa3-publish.yml**: Обеспечивает публикацию пакета с использованием стандарта SLSA3 для повышения безопасности.
- **python-package-conda.yml**: Автоматизирует сборку и публикацию пакета через Conda.
- **python-publish.yml**: Автоматизирует публикацию Python-пакета в PyPI.

---

## 8. Установка и использование

### Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/Lidiya-cutie/moderation-ai-project.git
   cd moderation-ai
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Установите пакет проекта:
   ```bash
   python setup.py install
   ```

### Использование

- Для обучения модели YOLO:
  ```bash
  train-yolo
  ```

- Для запуска авторазметки:
  ```bash
  auto-annotate
  ```

- Для запуска Telegram-бота:
  ```bash
  notify-bot
  ```

---

## 9. Поддержка и обратная связь

Если у вас возникли вопросы, замечания или предложения, свяжитесь со мной:
- **Email**: lidushehca188@mail.com
- **Telegram**: @lidiya_cutie

---

### Дополнительные примечания

- **Безопасность**: Убедитесь, что чувствительные данные (например, API-ключи) хранятся в переменных окружения, а не в коде.
- **Масштабируемость**: Проект разработан с учётом возможности масштабирования для обработки больших объёмов данных.
- **Логирование**: Все ключевые процессы логируются для упрощения отладки и анализа.

---

## 10. Что нужно скорректировать

1. **Документация API**:
   - Убедиться, что все API задокументированы с использованием Swagger (OpenApi).
   - Добавить примеры запросов и ответов.

2. **Обучающие ролики**:
   - Создать обучающие ролики для разных групп пользователей (например, для модераторов, администраторов, разработчиков).

3. **Тестирование безопасности**:
   - Регулярно проводить тестирование безопасности (например, с использованием trivy, semgrep, gitleaks).

4. **Мониторинг деградации ИИ**:
   - Реализовать механизм выборочной проверки результатов для идентификации деградации моделей.

5. **Резервное копирование**:
   - Настроить регулярное резервное копирование моделей и данных.

6. **Интеграция с внешними системами**:
   - Убедиться, что интеграция с АПР и РуссОнлайн работает корректно и соответствует требованиям.

---

Этот документ предоставляет полное описание архитектуры проекта, его компонентов и инструкций по использованию. Он поможет быстро разобраться в проекте и начать работу.
